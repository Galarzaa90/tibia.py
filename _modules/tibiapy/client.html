
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tibiapy.client &#8212; Tibia.py 5.6.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Tibia.py 5.6.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">tibiapy.client</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for tibiapy.client</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Asynchronous Tibia.com client.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">aiohttp</span>
<span class="kn">import</span> <span class="nn">aiohttp_socks</span>
<span class="kn">from</span> <span class="nn">pydantic.generics</span> <span class="kn">import</span> <span class="n">GenericModel</span>

<span class="kn">import</span> <span class="nn">tibiapy</span>
<span class="kn">from</span> <span class="nn">tibiapy.enums</span> <span class="kn">import</span> <span class="n">BattlEyeHighscoresFilter</span><span class="p">,</span> <span class="n">Category</span><span class="p">,</span> <span class="n">HouseType</span><span class="p">,</span> <span class="n">NewsCategory</span><span class="p">,</span> \
    <span class="n">NewsType</span><span class="p">,</span> <span class="n">VocationFilter</span><span class="p">,</span> <span class="n">NumericEnum</span><span class="p">,</span> <span class="n">BazaarType</span>
<span class="kn">from</span> <span class="nn">tibiapy.errors</span> <span class="kn">import</span> <span class="n">Forbidden</span><span class="p">,</span> <span class="n">NetworkError</span><span class="p">,</span> <span class="n">SiteMaintenanceError</span>
<span class="kn">from</span> <span class="nn">tibiapy.models</span> <span class="kn">import</span> <span class="n">Character</span><span class="p">,</span> <span class="n">SpellsSection</span><span class="p">,</span> <span class="n">Spell</span><span class="p">,</span> <span class="n">Leaderboard</span><span class="p">,</span> <span class="n">KillStatistics</span><span class="p">,</span> <span class="n">House</span><span class="p">,</span> <span class="n">HousesSection</span><span class="p">,</span> \
    <span class="n">Highscores</span><span class="p">,</span> <span class="n">Guild</span><span class="p">,</span> <span class="n">GuildWars</span><span class="p">,</span> <span class="n">GuildsSection</span><span class="p">,</span> <span class="n">CMPostArchive</span><span class="p">,</span> <span class="n">BoardEntry</span><span class="p">,</span> <span class="n">ForumBoard</span><span class="p">,</span> <span class="n">ForumThread</span><span class="p">,</span> <span class="n">ForumAnnouncement</span><span class="p">,</span> \
    <span class="n">CharacterBazaar</span><span class="p">,</span> <span class="n">Auction</span>
<span class="kn">from</span> <span class="nn">tibiapy.models.creature</span> <span class="kn">import</span> <span class="n">BoostedCreatures</span><span class="p">,</span> <span class="n">BoostableBosses</span><span class="p">,</span> <span class="n">CreaturesSection</span><span class="p">,</span> <span class="n">Creature</span>
<span class="kn">from</span> <span class="nn">tibiapy.models.event</span> <span class="kn">import</span> <span class="n">EventSchedule</span>
<span class="kn">from</span> <span class="nn">tibiapy.models.news</span> <span class="kn">import</span> <span class="n">NewsArchive</span><span class="p">,</span> <span class="n">News</span>
<span class="kn">from</span> <span class="nn">tibiapy.models.world</span> <span class="kn">import</span> <span class="n">World</span><span class="p">,</span> <span class="n">WorldOverview</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.bazaar</span> <span class="kn">import</span> <span class="n">AuctionParser</span><span class="p">,</span> <span class="n">CharacterBazaarParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.character</span> <span class="kn">import</span> <span class="n">CharacterParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.creature</span> <span class="kn">import</span> <span class="n">BoostedCreaturesParser</span><span class="p">,</span> <span class="n">BoostableBossesParser</span><span class="p">,</span> <span class="n">CreaturesSectionParser</span><span class="p">,</span> \
    <span class="n">CreatureParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.event</span> <span class="kn">import</span> <span class="n">EventScheduleParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.forum</span> <span class="kn">import</span> <span class="n">CMPostArchiveParser</span><span class="p">,</span> <span class="n">BoardEntryParser</span><span class="p">,</span> <span class="n">ForumBoardParser</span><span class="p">,</span> <span class="n">ForumThreadParser</span><span class="p">,</span> \
    <span class="n">ForumAnnouncementParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.guild</span> <span class="kn">import</span> <span class="n">GuildParser</span><span class="p">,</span> <span class="n">GuildWarsParser</span><span class="p">,</span> <span class="n">GuildsSectionParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.highscores</span> <span class="kn">import</span> <span class="n">HighscoresParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.house</span> <span class="kn">import</span> <span class="n">HouseParser</span><span class="p">,</span> <span class="n">HousesSectionParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.kill_statistics</span> <span class="kn">import</span> <span class="n">KillStatisticsParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.leaderboard</span> <span class="kn">import</span> <span class="n">LeaderboardParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.news</span> <span class="kn">import</span> <span class="n">NewsArchiveParser</span><span class="p">,</span> <span class="n">NewsParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.spell</span> <span class="kn">import</span> <span class="n">SpellsSectionParser</span><span class="p">,</span> <span class="n">SpellParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.parsers.world</span> <span class="kn">import</span> <span class="n">WorldParser</span><span class="p">,</span> <span class="n">WorldOverviewParser</span>
<span class="kn">from</span> <span class="nn">tibiapy.urls</span> <span class="kn">import</span> <span class="n">get_character_url</span><span class="p">,</span> <span class="n">get_world_guilds_url</span><span class="p">,</span> <span class="n">get_guild_url</span><span class="p">,</span> <span class="n">get_house_url</span><span class="p">,</span> <span class="n">get_world_overview_url</span><span class="p">,</span> \
    <span class="n">get_news_archive_url</span><span class="p">,</span> <span class="n">get_news_url</span><span class="p">,</span> <span class="n">get_forum_board_url</span><span class="p">,</span> <span class="n">get_forum_announcement_url</span><span class="p">,</span> <span class="n">get_forum_thread_url</span><span class="p">,</span> \
    <span class="n">get_highscores_url</span><span class="p">,</span> <span class="n">get_kill_statistics_url</span><span class="p">,</span> <span class="n">get_forum_post_url</span><span class="p">,</span> <span class="n">get_event_schedule_url</span><span class="p">,</span> <span class="n">get_houses_section_url</span><span class="p">,</span> \
    <span class="n">get_auction_url</span><span class="p">,</span> <span class="n">get_bazaar_url</span><span class="p">,</span> <span class="n">get_cm_post_archive_url</span><span class="p">,</span> <span class="n">get_leaderboards_url</span><span class="p">,</span> <span class="n">get_creatures_section_url</span><span class="p">,</span> \
    <span class="n">get_creature_url</span><span class="p">,</span> <span class="n">get_boostable_bosses_url</span><span class="p">,</span> <span class="n">get_spells_section_url</span><span class="p">,</span> <span class="n">get_spell_url</span><span class="p">,</span> <span class="n">get_world_url</span><span class="p">,</span> <span class="n">get_guild_wars_url</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;TibiaResponse&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># Tibia.com&#39;s cache for the community section is 5 minutes.</span>
<span class="c1"># This limit is not sent anywhere, so there&#39;s no way to automate it.</span>
<span class="n">CACHE_LIMIT</span> <span class="o">=</span> <span class="mi">300</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;tibiapy&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="TibiaResponse"><a class="viewcode-back" href="../../api.html#tibiapy.TibiaResponse">[docs]</a><span class="k">class</span> <span class="nc">TibiaResponse</span><span class="p">(</span><span class="n">GenericModel</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a response from Tibia.com.&quot;&quot;&quot;</span>

    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The date and time when the page was fetched, in UTC.&quot;&quot;&quot;</span>
    <span class="n">cached</span><span class="p">:</span> <span class="nb">bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether the response is cached or it is a fresh response.&quot;&quot;&quot;</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The age of the cache in seconds.&quot;&quot;&quot;</span>
    <span class="n">fetching_time</span><span class="p">:</span> <span class="nb">float</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The time in seconds it took for Tibia.com to respond.&quot;&quot;&quot;</span>
    <span class="n">parsing_time</span><span class="p">:</span> <span class="nb">float</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The time in seconds it took for the response to be parsed into data.&quot;&quot;&quot;</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">T</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The data contained in the response.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">time_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`datetime.timedelta`: The time left for the cache of this response to expire.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">CACHE_LIMIT</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
                <span class="o">-</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">seconds_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`int`: The time left in seconds for this response&#39;s cache to expire.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_left</span><span class="o">.</span><span class="n">seconds</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_raw</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">raw_response</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">parsing_time</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">raw_response</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="n">cached</span><span class="o">=</span><span class="n">raw_response</span><span class="o">.</span><span class="n">cached</span><span class="p">,</span>
            <span class="n">age</span><span class="o">=</span><span class="n">raw_response</span><span class="o">.</span><span class="n">age</span><span class="p">,</span>
            <span class="n">fetching_time</span><span class="o">=</span><span class="n">raw_response</span><span class="o">.</span><span class="n">fetching_time</span><span class="p">,</span>
            <span class="n">parsing_time</span><span class="o">=</span><span class="n">parsing_time</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span>
        <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">json_encoders</span> <span class="o">=</span> <span class="p">{</span><span class="n">NumericEnum</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="p">}</span></div>


<span class="k">class</span> <span class="nc">RawResponse</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientResponse</span><span class="p">,</span> <span class="n">fetching_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fetching_time</span> <span class="o">=</span> <span class="n">fetching_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CF-Cache-Status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;HIT&quot;</span>
        <span class="n">age</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">age</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">age</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> timestamp=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="si">!r}</span><span class="s2"> fetching_time=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fetching_time</span><span class="si">!r}</span><span class="s2"> &quot;</span> \
               <span class="sa">f</span><span class="s2">&quot;cached=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cached</span><span class="si">!r}</span><span class="s2"> age=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>


<div class="viewcode-block" id="Client"><a class="viewcode-back" href="../../api.html#tibiapy.Client">[docs]</a><span class="k">class</span> <span class="nc">Client</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An asynchronous client that fetches information from Tibia.com.</span>

<span class="sd">    The client uses a :class:`aiohttp.ClientSession` to request the information.</span>
<span class="sd">    A single session is shared across all operations.</span>

<span class="sd">    If desired, a custom ClientSession instance may be passed, instead of creating a new one.</span>

<span class="sd">    .. versionadded:: 2.0.0</span>

<span class="sd">    .. versionchanged:: 3.0.0</span>
<span class="sd">        All methods return a :class:`TibiaResponse` instance, containing additional information such as cache age.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    loop : :class:`asyncio.AbstractEventLoop`</span>
<span class="sd">        The event loop to use. The default one will be used if not defined.</span>
<span class="sd">    session: :class:`aiohttp.ClientSession`</span>
<span class="sd">        The client session that will be used for the requests. One will be created by default.</span>
<span class="sd">    proxy_url: :class:`str`</span>
<span class="sd">        The URL of the SOCKS proxy to use for requests.</span>
<span class="sd">        Note that if a session is passed, the SOCKS proxy won&#39;t be used and must be applied when creating the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">proxy_url</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span> <span class="k">if</span> <span class="n">loop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">loop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_ready</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">session</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">:</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span> <span class="o">=</span> <span class="n">session</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session_ready</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_initialize_session</span><span class="p">(</span><span class="n">proxy_url</span><span class="p">))</span>

    <span class="c1"># region Private Methods</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_initialize_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proxy_url</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the aiohttp session object.&quot;&quot;&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s2">&quot;Tibia.py/</span><span class="si">%s</span><span class="s2"> (+https://github.com/Galarzaa90/tibia.py)&quot;</span> <span class="o">%</span> <span class="n">tibiapy</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span>
            <span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">:</span> <span class="s2">&quot;deflate, gzip&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">connector</span> <span class="o">=</span> <span class="n">aiohttp_socks</span><span class="o">.</span><span class="n">SocksConnector</span><span class="o">.</span><span class="n">from_url</span><span class="p">(</span><span class="n">proxy_url</span><span class="p">)</span> <span class="k">if</span> <span class="n">proxy_url</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">:</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">(</span>
            <span class="n">loop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">connector</span><span class="o">=</span><span class="n">connector</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_ready</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_handle_status</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">status_code</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">fetching_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle error status codes, raising exceptions if necessary.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status_code</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Forbidden</span><span class="p">(</span><span class="s2">&quot;403 Forbidden: Might be getting rate-limited&quot;</span><span class="p">,</span> <span class="n">fetching_time</span><span class="o">=</span><span class="n">fetching_time</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="s2">&quot;Request error, status code: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">status_code</span><span class="p">,</span> <span class="n">fetching_time</span><span class="o">=</span><span class="n">fetching_time</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Base request, handling possible error statuses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method: :class:`str`</span>
<span class="sd">            The HTTP method to use for the request.</span>
<span class="sd">        url: :class:`str`</span>
<span class="sd">            The URL that will be requested.</span>
<span class="sd">        data: :class:`dict`</span>
<span class="sd">            A mapping representing the form-data to send as part of the request.</span>
<span class="sd">        headers: :class:`dict`</span>
<span class="sd">            A mapping representing the headers to send as part of the request.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`RawResponse`</span>
<span class="sd">            The raw response obtained from the server.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden:</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_ready</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;www.tibia.com&quot;</span><span class="p">,</span> <span class="s2">&quot;www.test.tibia.com&quot;</span><span class="p">)</span>
        <span class="n">init_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
                <span class="n">diff_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span><span class="o">-</span><span class="n">init_time</span>
                <span class="k">if</span> <span class="s2">&quot;maintenance.tibia.com&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">url</span><span class="p">):</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> | </span><span class="si">%s</span><span class="s2"> | </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> | maintenance.tibia.com&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">SiteMaintenanceError</span><span class="p">(</span><span class="s2">&quot;Tibia.com is down for maintenance.&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> | </span><span class="si">%s</span><span class="s2"> | </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> | </span><span class="si">%d</span><span class="s2">ms&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">diff_time</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handle_status</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">diff_time</span><span class="p">)</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">RawResponse</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">diff_time</span><span class="p">)</span>
                <span class="n">response</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;aiohttp.ClientError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">init_time</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">aiohttp_socks</span><span class="o">.</span><span class="n">SocksConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;aiohttp_socks.SocksConnectionError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">init_time</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UnicodeDecodeError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">init_time</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_fetch_all_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auction_id</span><span class="p">,</span> <span class="n">paginator</span><span class="p">,</span> <span class="n">item_type</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch all the pages of an auction paginator.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auction_id: :class:`int`</span>
<span class="sd">            The id of the auction.</span>
<span class="sd">        paginator:</span>
<span class="sd">            The paginator object</span>
<span class="sd">        item_type: :class:`int`</span>
<span class="sd">            The item type.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_page</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">current_page</span> <span class="o">&lt;=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">total_pages</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_ajax_page</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">item_type</span><span class="p">,</span> <span class="n">current_page</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
                <span class="n">entries</span> <span class="o">=</span> <span class="n">AuctionParser</span><span class="o">.</span><span class="n">_parse_page_items</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">paginator</span><span class="p">)</span>
                <span class="n">paginator</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
            <span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">paginator</span><span class="o">.</span><span class="n">is_fully_fetched</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_fetch_ajax_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auction_id</span><span class="p">,</span> <span class="n">type_id</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch an ajax page from the paginated summaries in the auction section.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auction_id: :class:`int`</span>
<span class="sd">            The id of the auction.</span>
<span class="sd">        type_id: :class:`int`</span>
<span class="sd">            The ID of the type of the catalog to check.</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The page number to fetch.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`str`:</span>
<span class="sd">            The HTML content of the obtained page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x-requested-with&quot;</span><span class="p">:</span> <span class="s2">&quot;XMLHttpRequest&quot;</span><span class="p">}</span>
        <span class="n">page_response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://www.tibia.com/websiteservices/handle_charactertrades.php?&quot;</span>
                                                   <span class="sa">f</span><span class="s2">&quot;auctionid=</span><span class="si">{</span><span class="n">auction_id</span><span class="si">}</span><span class="s2">&amp;&quot;</span>
                                                   <span class="sa">f</span><span class="s2">&quot;type=</span><span class="si">{</span><span class="n">type_id</span><span class="si">}</span><span class="s2">&amp;&quot;</span>
                                                   <span class="sa">f</span><span class="s2">&quot;currentpage=</span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                                            <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">page_response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x0a</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">decoder</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AjaxObjects&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># endregion</span>

    <span class="c1"># region Bazaar</span>
<div class="viewcode-block" id="Client.fetch_current_auctions"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_current_auctions">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_current_auctions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the current auctions in the bazaar.</span>

<span class="sd">        .. versionadded:: 3.3.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The desired page to display.</span>
<span class="sd">        filters: :class:`AuctionFilters`</span>
<span class="sd">            The filtering criteria to use.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`CharacterBazaar`</span>
<span class="sd">            The current auctions.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the page number is not 1 or greater.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;page must be 1 or greater.&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_bazaar_url</span><span class="p">(</span><span class="n">BazaarType</span><span class="o">.</span><span class="n">CURRENT</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">filters</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">current_auctions</span> <span class="o">=</span> <span class="n">CharacterBazaarParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">current_auctions</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_auction_history"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_auction_history">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_auction_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the auction history of the bazaar.</span>

<span class="sd">        .. versionadded:: 3.3.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The page to display.</span>
<span class="sd">        filters: :class:`AuctionFilters`</span>
<span class="sd">            The filtering criteria to use.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`CharacterBazaar`</span>
<span class="sd">            The character bazaar containing the auction history.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the page number is not 1 or greater.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;page must be 1 or greater.&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_bazaar_url</span><span class="p">(</span><span class="n">BazaarType</span><span class="o">.</span><span class="n">HISTORY</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">filters</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">auction_history</span> <span class="o">=</span> <span class="n">CharacterBazaarParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">auction_history</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_auction"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_auction">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_auction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auction_id</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">fetch_items</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fetch_mounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fetch_outfits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">fetch_familiars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_details</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch an auction by its ID.</span>

<span class="sd">        .. versionadded:: 3.3.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auction_id: :class:`int`</span>
<span class="sd">            The ID of the auction.</span>
<span class="sd">        fetch_items: :class:`bool`</span>
<span class="sd">            Whether to fetch all of the character&#39;s items. By default only the first page is fetched.</span>
<span class="sd">        fetch_mounts: :class:`bool`</span>
<span class="sd">            Whether to fetch all of the character&#39;s mounts. By default only the first page is fetched.</span>
<span class="sd">        fetch_outfits: :class:`bool`</span>
<span class="sd">            Whether to fetch all of the character&#39;s outfits. By default only the first page is fetched.</span>
<span class="sd">        skip_details: :class:`bool`, optional</span>
<span class="sd">            Whether to skip parsing the entire auction and only parse the information shown in lists. False by default.</span>

<span class="sd">            This allows fetching basic information like name, level, vocation, world, bid and status, shaving off some</span>
<span class="sd">            parsing time.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Auction`</span>
<span class="sd">            The auction matching the ID if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the auction id is not 1 or greater.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auction_id</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;auction_id must be 1 or greater.&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_auction_url</span><span class="p">(</span><span class="n">auction_id</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">auction</span> <span class="o">=</span> <span class="n">AuctionParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">auction_id</span><span class="p">,</span> <span class="n">skip_details</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">if</span> <span class="n">auction</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_details</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fetch_items</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">items</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">store_items</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fetch_mounts</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">mounts</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">store_mounts</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fetch_outfits</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">outfits</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">store_outfits</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fetch_familiars</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_pages</span><span class="p">(</span><span class="n">auction_id</span><span class="p">,</span> <span class="n">auction</span><span class="o">.</span><span class="n">details</span><span class="o">.</span><span class="n">outfits</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">auction</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

<div class="viewcode-block" id="Client.fetch_cm_post_archive"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_cm_post_archive">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_cm_post_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the CM post archive.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start_date: :class: `datetime.date`</span>
<span class="sd">            The start date to display.</span>
<span class="sd">        end_date: :class: `datetime.date`</span>
<span class="sd">            The end date to display.</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The desired page to display.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`CMPostArchive`</span>
<span class="sd">            The CM Post Archive.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the start_date is more recent than the end date or page number is not 1 or greater.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;start_date cannot be more recent than end_date&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;page cannot be lower than 1.&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_cm_post_archive_url</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">page</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">cm_post_archive</span> <span class="o">=</span> <span class="n">CMPostArchiveParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">cm_post_archive</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_event_schedule"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_event_schedule">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_event_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the event calendar. By default, it gets the events for the current month.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        month: :class:`int`</span>
<span class="sd">            The month of the events to display.</span>
<span class="sd">        year: :class:`int`</span>
<span class="sd">            The year of the events to display.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`EventSchedule`</span>
<span class="sd">            The event calendar.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If only one of year or month are defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">year</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">month</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">year</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">month</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;both year and month must be defined or neither must be defined.&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_event_schedule_url</span><span class="p">(</span><span class="n">month</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">calendar</span> <span class="o">=</span> <span class="n">EventScheduleParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">calendar</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># region Forums</span>
<div class="viewcode-block" id="Client.fetch_forum_community_boards"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_community_boards">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_community_boards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the forum&#39;s community boards.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of list of :class:`BoardEntry`</span>
<span class="sd">            The forum boards in the community section.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">BoardEntry</span><span class="o">.</span><span class="n">get_community_boards_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boards</span> <span class="o">=</span> <span class="n">BoardEntryParser</span><span class="o">.</span><span class="n">list_from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boards</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_support_boards"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_support_boards">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_support_boards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the forum&#39;s community boards.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of list of :class:`BoardEntry`</span>
<span class="sd">            The forum boards in the community section.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">BoardEntry</span><span class="o">.</span><span class="n">get_support_boards_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boards</span> <span class="o">=</span> <span class="n">BoardEntryParser</span><span class="o">.</span><span class="n">list_from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boards</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_world_boards"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_world_boards">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_world_boards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the forum&#39;s world boards.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of list of :class:`BoardEntry`</span>
<span class="sd">            The forum boards in the world section.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">BoardEntry</span><span class="o">.</span><span class="n">get_world_boards_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boards</span> <span class="o">=</span> <span class="n">BoardEntryParser</span><span class="o">.</span><span class="n">list_from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boards</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_trade_boards"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_trade_boards">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_trade_boards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the forum&#39;s trade boards.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of list of :class:`BoardEntry`</span>
<span class="sd">            The forum boards in the trade section.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">BoardEntry</span><span class="o">.</span><span class="n">get_trade_boards_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boards</span> <span class="o">=</span> <span class="n">BoardEntryParser</span><span class="o">.</span><span class="n">list_from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boards</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_board"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_board">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_board</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board_id</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a forum board with a given id.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        board_id : :class:`int`</span>
<span class="sd">            The id of the board.</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The page number to show.</span>
<span class="sd">        age: :class:`int`</span>
<span class="sd">            The maximum age in days of the threads to display.</span>

<span class="sd">            To show threads of all ages, use -1.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`ForumBoard`</span>
<span class="sd">            A response containing the forum, if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_forum_board_url</span><span class="p">(</span><span class="n">board_id</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">age</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">board</span> <span class="o">=</span> <span class="n">ForumBoardParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_thread"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_thread">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thread_id</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a forum thread with a given id.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thread_id : :class:`int`</span>
<span class="sd">            The id of the thread.</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The desired page to display, by default 1.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`ForumThread`</span>
<span class="sd">            A response containing the forum, if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_forum_thread_url</span><span class="p">(</span><span class="n">thread_id</span><span class="p">,</span> <span class="n">page</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">ForumThreadParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">thread</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_post"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_post">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">post_id</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a forum post with a given id.</span>

<span class="sd">        The thread that contains the post will be returned, containing the desired post in</span>
<span class="sd">        :py:attr:`ForumThread.anchored_post`.</span>

<span class="sd">        The displayed page will be the page where the post is located.</span>

<span class="sd">        .. versionadded:: 3.1.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        post_id : :class:`int`</span>
<span class="sd">            The id of the post.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`ForumThread`</span>
<span class="sd">            A response containing the forum, if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_forum_post_url</span><span class="p">(</span><span class="n">post_id</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">ForumThreadParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thread</span><span class="p">:</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">anchored_post</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">thread</span><span class="o">.</span><span class="n">posts</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">post_id</span> <span class="o">==</span> <span class="n">post_id</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">thread</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_forum_announcement"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_forum_announcement">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_forum_announcement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">announcement_id</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a forum announcement.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        announcement_id: :class:`int`</span>
<span class="sd">            The id of the desired announcement.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`ForumAnnouncement`</span>
<span class="sd">            The forum announcement, if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_forum_announcement_url</span><span class="p">(</span><span class="n">announcement_id</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">announcement</span> <span class="o">=</span> <span class="n">ForumAnnouncementParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">announcement_id</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">announcement</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

<div class="viewcode-block" id="Client.fetch_boosted_creature_and_boss"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_boosted_creature_and_boss">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_boosted_creature_and_boss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch today&#39;s boosted creature and boss.</span>

<span class="sd">        .. versionadded:: 5.3.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`BoostedCreatures`</span>
<span class="sd">            The boosted creature and boss of the day.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_news_archive_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boosted_creatures</span> <span class="o">=</span> <span class="n">BoostedCreaturesParser</span><span class="o">.</span><span class="n">from_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boosted_creatures</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># region Bosses</span>
<div class="viewcode-block" id="Client.fetch_boosted_boss"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_boosted_boss">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_boosted_boss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch today&#39;s boosted boss.</span>

<span class="sd">        .. versionadded:: 5.3.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`BossEntry`</span>
<span class="sd">            The boosted boss of the day.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_news_archive_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boosted_creature</span> <span class="o">=</span> <span class="n">BoostableBossesParser</span><span class="o">.</span><span class="n">boosted_boss_from_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boosted_creature</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_library_bosses"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_library_bosses">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_library_bosses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the bosses from the library section.</span>

<span class="sd">        .. versionadded:: 4.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`BoostableBosses`</span>
<span class="sd">            The creature&#39;s section in Tibia.com</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_boostable_bosses_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boosted_creature</span> <span class="o">=</span> <span class="n">BoostableBossesParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boosted_creature</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region Creatures</span>
<div class="viewcode-block" id="Client.fetch_boosted_creature"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_boosted_creature">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_boosted_creature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch today&#39;s boosted creature.</span>

<span class="sd">        .. versionadded:: 2.1.0</span>
<span class="sd">        .. versionchanged:: 4.0.0</span>
<span class="sd">            The return type of the data returned was changed to :class:`Creature`, previous type was removed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`CreatureEntry`</span>
<span class="sd">            The boosted creature of the day.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_news_archive_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boosted_creature</span> <span class="o">=</span> <span class="n">CreaturesSectionParser</span><span class="o">.</span><span class="n">boosted_creature_from_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boosted_creature</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_library_creatures"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_library_creatures">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_library_creatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the creatures from the library section.</span>

<span class="sd">        .. versionadded:: 4.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`CreaturesSection`</span>
<span class="sd">            The creature&#39;s section in Tibia.com</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_creatures_section_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boosted_creature</span> <span class="o">=</span> <span class="n">CreaturesSectionParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boosted_creature</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_creature"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_creature">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_creature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a creature&#39;s information from the Tibia.com library.</span>

<span class="sd">        .. versionadded:: 4.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        identifier: :class:`str`</span>
<span class="sd">            The internal name of the race.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Creature`</span>
<span class="sd">            The creature&#39;s section in Tibia.com</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_creature_url</span><span class="p">(</span><span class="n">identifier</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">boosted_creature</span> <span class="o">=</span> <span class="n">CreatureParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">boosted_creature</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

<div class="viewcode-block" id="Client.fetch_character"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_character">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_character</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a character by its name from Tibia.com.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: :class:`str`</span>
<span class="sd">            The name of the character.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Character`</span>
<span class="sd">            A response containing the character, if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_character_url</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="n">CharacterParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># region Guilds</span>
<div class="viewcode-block" id="Client.fetch_guild"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_guild">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_guild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a guild by its name from Tibia.com.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: :class:`str`</span>
<span class="sd">            The name of the guild. The case must match exactly.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Guild`</span>
<span class="sd">            A response containing the found guild, if any.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_guild_url</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">guild</span> <span class="o">=</span> <span class="n">GuildParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">guild</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_guild_wars"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_guild_wars">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_guild_wars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a guild&#39;s wars by its name from Tibia.com.</span>

<span class="sd">        .. versionadded:: 3.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: :class:`str`</span>
<span class="sd">            The name of the guild. The case must match exactly.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`GuildWars`</span>
<span class="sd">            A response containing the found guild&#39;s wars.</span>

<span class="sd">            If the guild doesn&#39;t exist, the displayed data will show a guild with no wars instead of indicating the</span>
<span class="sd">            guild doesn&#39;t exist.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_guild_wars_url</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">guild_wars</span> <span class="o">=</span> <span class="n">GuildWarsParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">guild_wars</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

<div class="viewcode-block" id="Client.fetch_house"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_house">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_house</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">house_id</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a house in a specific world by its id.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        house_id: :class:`int`</span>
<span class="sd">            The house&#39;s internal id.</span>
<span class="sd">        world: :class:`str`</span>
<span class="sd">            The name of the world to look for.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`House`</span>
<span class="sd">            The house if found, :obj:`None` otherwise.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_house_url</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="n">house_id</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">house</span> <span class="o">=</span> <span class="n">HouseParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">house</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_highscores_page"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_highscores_page">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_highscores_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">Category</span><span class="o">.</span><span class="n">EXPERIENCE</span><span class="p">,</span> <span class="n">vocation</span><span class="o">=</span><span class="n">VocationFilter</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">battleye_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pvp_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a single highscores page from Tibia.com.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        It is not possible to use BattlEye or PvPType filters when requesting a specific world.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        world: :class:`str`</span>
<span class="sd">            The world to search the highscores in.</span>
<span class="sd">        category: :class:`Category`</span>
<span class="sd">            The highscores category to search, by default Experience.</span>
<span class="sd">        vocation: :class:`VocationFilter`</span>
<span class="sd">            The vocation filter to use. No filter used by default.</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The page to fetch, by default the first page is fetched.</span>
<span class="sd">        battleye_type: :class:`BattlEyeFilter`</span>
<span class="sd">            The type of BattlEye protection to display results from.</span>
<span class="sd">        pvp_types: :class:`list` of :class:`PvpTypeFilter`</span>
<span class="sd">            The list of PvP types to filter the results for.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Highscores`</span>
<span class="sd">            The highscores information or :obj:`None` if not found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If an invalid filter combination is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pvp_types</span> <span class="o">=</span> <span class="n">pvp_types</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">world</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">((</span><span class="n">battleye_type</span> <span class="ow">and</span> <span class="n">battleye_type</span> <span class="o">!=</span> <span class="n">BattlEyeHighscoresFilter</span><span class="o">.</span><span class="n">ANY_WORLD</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pvp_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;BattleEye and PvP type filters can only be used when fetching all worlds.&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_highscores_url</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">vocation</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">battleye_type</span><span class="p">,</span>
                                                                 <span class="n">pvp_types</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">highscores</span> <span class="o">=</span> <span class="n">HighscoresParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">highscores</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_kill_statistics"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_kill_statistics">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_kill_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the kill statistics of a world from Tibia.com.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        world: :class:`str`</span>
<span class="sd">            The name of the world.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`KillStatistics`</span>
<span class="sd">            The kill statistics of the world if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_kill_statistics_url</span><span class="p">(</span><span class="n">world</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">kill_statistics</span> <span class="o">=</span> <span class="n">KillStatisticsParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">kill_statistics</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_leaderboard"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_leaderboard">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_leaderboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the leaderboards for a specific world and rotation.</span>

<span class="sd">        .. versionadded:: 5.0.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        world: :class:`str`</span>
<span class="sd">            The name of the world.</span>
<span class="sd">        rotation: :class:`int`</span>
<span class="sd">            The ID of the rotation. By default it will get the current rotation.</span>
<span class="sd">        page: :class:`int`</span>
<span class="sd">            The page to get.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Leaderboard`</span>
<span class="sd">            The leaderboards of the world if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_leaderboards_url</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">page</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">leaderboard</span> <span class="o">=</span> <span class="n">LeaderboardParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">leaderboard</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># region Worlds</span>
<div class="viewcode-block" id="Client.fetch_world"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_world">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_world</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a world from Tibia.com.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: :class:`str`</span>
<span class="sd">            The name of the world.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`World`</span>
<span class="sd">            A response containig the he world&#39;s information if found, :obj:`None` otherwise.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_world_url</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">world</span> <span class="o">=</span> <span class="n">WorldParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_world_houses"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_world_houses">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_world_houses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">town</span><span class="p">,</span> <span class="n">house_type</span><span class="o">=</span><span class="n">HouseType</span><span class="o">.</span><span class="n">HOUSE</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the house list of a world and type.</span>

<span class="sd">        .. versionchanged:: 5.0.0</span>
<span class="sd">            The data attribute of the response contains an instance of :class:`HousesSection` instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        world: :class:`str`</span>
<span class="sd">            The name of the world.</span>
<span class="sd">        town: :class:`str`</span>
<span class="sd">            The name of the town.</span>
<span class="sd">        house_type: :class:`HouseType`</span>
<span class="sd">            The type of building. House by default.</span>
<span class="sd">        status: :class:`HouseStatus`, optional</span>
<span class="sd">            The house status to filter results. By default, no filters will be applied.</span>
<span class="sd">        order: :class:`HouseOrder`, optional</span>
<span class="sd">            The ordering to use for the results. By default, they are sorted by name.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`HousesSection`</span>
<span class="sd">            A response containing the lists of houses meeting the criteria if found.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_houses_section_url</span><span class="p">(</span><span class="n">world</span><span class="o">=</span><span class="n">world</span><span class="p">,</span> <span class="n">town</span><span class="o">=</span><span class="n">town</span><span class="p">,</span> <span class="n">house_type</span><span class="o">=</span><span class="n">house_type</span><span class="p">,</span>
                                                                     <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">world_houses</span> <span class="o">=</span> <span class="n">HousesSectionParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">world_houses</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_world_guilds"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_world_guilds">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_world_guilds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the list of guilds in a world from Tibia.com.</span>

<span class="sd">        If a world that does not exist is passed, the world attribute of the result will be :obj:`None`.</span>
<span class="sd">        If the world attribute is set, but the list is empty, it just means the world has no guilds.</span>

<span class="sd">        .. versionchanged:: 5.0.0</span>
<span class="sd">            The data attribute of the response contains an instance of :class:`GuildsSection` instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        world: :class:`str`</span>
<span class="sd">            The name of the world.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`GuildsSection`</span>
<span class="sd">            A response containing the guilds section for the specified world.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_world_guilds_url</span><span class="p">(</span><span class="n">world</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">guilds</span> <span class="o">=</span> <span class="n">GuildsSectionParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">guilds</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_world_list"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_world_list">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_world_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the world overview information from Tibia.com.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`WorldOverview`</span>
<span class="sd">            A response containing the world overview information.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_world_overview_url</span><span class="p">(),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">world_overview</span> <span class="o">=</span> <span class="n">WorldOverviewParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">world_overview</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

    <span class="c1"># endregion</span>

    <span class="c1"># region News</span>
<div class="viewcode-block" id="Client.fetch_news_archive"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_news_archive">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_news_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch news from the archive meeting the search criteria.</span>

<span class="sd">        .. versionchanged:: 5.0.0</span>
<span class="sd">            The data attribute of the response contains an instance of :class:`NewsArchive` instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start_date: :class:`datetime.date`</span>
<span class="sd">            The beginning date to search dates in.</span>
<span class="sd">        end_date: :class:`datetime.date`</span>
<span class="sd">            The end date to search dates in.</span>
<span class="sd">        categories: `list` of :class:`NewsCategory`</span>
<span class="sd">            The allowed categories to show. If left blank, all categories will be searched.</span>
<span class="sd">        types : `list` of :class:`NewsType`</span>
<span class="sd">            The allowed news types to show. if unused, all types will be searched.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`NewsArchive`</span>
<span class="sd">            The news meeting the search criteria.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If ``begin_date`` is more recent than ``to_date``.</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;start_date can&#39;t be more recent than end_date&quot;</span><span class="p">)</span>
        <span class="n">form_data</span> <span class="o">=</span> <span class="n">NewsArchiveParser</span><span class="o">.</span><span class="n">get_form_data</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">categories</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="n">get_news_archive_url</span><span class="p">(),</span> <span class="n">form_data</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">news</span> <span class="o">=</span> <span class="n">NewsArchiveParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">news</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_recent_news"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_recent_news">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_recent_news</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch all the published news in the last specified days.</span>

<span class="sd">        This is a shortcut for :meth:`fetch_news_archive`, to handle dates more easily.</span>

<span class="sd">        .. versionchanged:: 5.0.0</span>
<span class="sd">            The data attribute of the response contains an instance of :class:`NewsArchive` instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        days: :class:`int`</span>
<span class="sd">            The number of days to search, by default 30.</span>
<span class="sd">        categories: `list` of :class:`NewsCategory`</span>
<span class="sd">            The allowed categories to show. If left blank, all categories will be searched.</span>
<span class="sd">        types : `list` of :class:`NewsType`</span>
<span class="sd">            The allowed news types to show. if unused, all types will be searched.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`NewsArchive`</span>
<span class="sd">            The news posted in the last specified days.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
        <span class="n">begin</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_news_archive</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">categories</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_news"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_news">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_news</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">news_id</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a news entry by its id from Tibia.com.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        news_id: :class:`int`</span>
<span class="sd">            The id of the news entry.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`News`</span>
<span class="sd">            The news entry if found, :obj:`None` otherwise.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_news_url</span><span class="p">(</span><span class="n">news_id</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">news</span> <span class="o">=</span> <span class="n">NewsParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">news_id</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">news</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>
    <span class="c1"># endregion</span>

    <span class="c1"># region Spells</span>
<div class="viewcode-block" id="Client.fetch_spells"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_spells">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_spells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">vocation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spell_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">premium</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch the spells section.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vocation: :class:`VocationSpellFilter`, optional</span>
<span class="sd">            The vocation to filter in spells for.</span>
<span class="sd">        group: :class:`SpellGroup`, optional</span>
<span class="sd">            The spell&#39;s primary cooldown group.</span>
<span class="sd">        spell_type: :class:`SpellType`, optional</span>
<span class="sd">            The type of spells to show.</span>
<span class="sd">        premium: :class:`bool`, optional</span>
<span class="sd">            The type of premium requirement to filter. :obj:`None` means any premium requirement.</span>
<span class="sd">        sort: :class:`SpellSorting`, optional</span>
<span class="sd">            The field to sort spells by.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`SpellsSection`</span>
<span class="sd">            The spells section with the results.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_spells_section_url</span><span class="p">(</span><span class="n">vocation</span><span class="o">=</span><span class="n">vocation</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
                                                                    <span class="n">spell_type</span><span class="o">=</span><span class="n">spell_type</span><span class="p">,</span> <span class="n">premium</span><span class="o">=</span><span class="n">premium</span><span class="p">,</span>
                                                                    <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">spells</span> <span class="o">=</span> <span class="n">SpellsSectionParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">spells</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.fetch_spell"><a class="viewcode-back" href="../../api.html#tibiapy.Client.fetch_spell">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_spell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a spell by its identifier.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        identifier: :class:`str`</span>
<span class="sd">            The spell&#39;s identifier. This is usually the name of the spell in lowercase and with no spaces.</span>
<span class="sd">        test: :class:`bool`</span>
<span class="sd">            Whether to request the test website instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`TibiaResponse` of :class:`Spell`</span>
<span class="sd">            The spell if found, :obj:`None` otherwise.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Forbidden</span>
<span class="sd">            If a 403 Forbidden error was returned.</span>
<span class="sd">            This usually means that Tibia.com is rate-limiting the client because of too many requests.</span>
<span class="sd">        NetworkError</span>
<span class="sd">            If there&#39;s any connection errors during the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">get_spell_url</span><span class="p">(</span><span class="n">identifier</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">spells</span> <span class="o">=</span> <span class="n">SpellParser</span><span class="o">.</span><span class="n">from_content</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">parsing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TibiaResponse</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">spells</span><span class="p">,</span> <span class="n">parsing_time</span><span class="p">)</span></div></div>
    <span class="c1"># endregion</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Tibia.py</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Galarzaa90&repo=tibia.py&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/Galarzaa90/tibia.py">
    <img
        alt="https://secure.travis-ci.org/Galarzaa90/tibia.py.svg?branch=master"
        src="https://secure.travis-ci.org/Galarzaa90/tibia.py.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>


<h3 class="donation">Donate/support</h3>



<p>
<a class="badge" href="https://beerpay.io/Galarzaa90/tibia.py">
<img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate">
</a>
</p>





        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2021, Allan Galarza.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 6.1.3.
  </div>
  
  </body>
</html>